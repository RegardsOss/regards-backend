########################################
# Gateway microservice configuration   #
########################################
# CORS policy
regards.gateway.cors.mappings.[/api/**].allowedOrigins=*

# Default values
#regards.gateway.cors.mappings.[/api/**].allowedHeaders=authorization,content-type,scope
#regards.gateway.cors.mappings.[/api/**].allowedMethods=OPTIONS,HEAD,GET,PUT,POST,DELETE,PATCH
#regards.gateway.cors.mappings.[/api/**].maxAge=3600
#regards.gateway.cors.mappings.[/api/**].allowCredentials=true
server.jetty.connection-idle-timeout=30000

# Spring cloud gateway configuration
# gateway timeout configuration
spring.cloud.gateway.httpclient.response-timeout=60000
spring.cloud.gateway.httpclient.connect-timeout=10s
# enable registry support for routing
spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.gateway.x-forwarded.for-enabled=true

# Routes
prefix.path=/api/v1
# default filters
spring.cloud.gateway.default-filters[0]=PrefixPath=${prefix.path}

# Below are routes that could be access on microservices directly but for security reasons they are to be redirected using fake serviceId to limit access.
# model attributes route
## RS-DAM
spring.cloud.gateway.routes[0].id=rs-dam-model-attributes
spring.cloud.gateway.routes[0].uri=lb://rs-dam
spring.cloud.gateway.routes[0].predicates[0]=Path=/rs-dam-public/**/models/attributes
spring.cloud.gateway.routes[0].filters[0]=StripPrefix=2

# model per id attribute route
spring.cloud.gateway.routes[1].id=rs-dam-model-attributes-id
spring.cloud.gateway.routes[1].uri=lb://rs-dam
spring.cloud.gateway.routes[1].predicates[0]=Path=/rs-dam-public/**/models/*/attributes
spring.cloud.gateway.routes[1].filters[0]=StripPrefix=2

# model type attribute route
spring.cloud.gateway.routes[2].id=rs-dam-model-type
spring.cloud.gateway.routes[2].uri=lb://rs-dam
spring.cloud.gateway.routes[2].predicates[0]=Path=/rs-dam-public/**/models/attributes/modeltype/*
spring.cloud.gateway.routes[2].filters[0]=StripPrefix=2

## RS-ADMIN-INSTANCE
# admin instance projects route
spring.cloud.gateway.routes[3].id=rs-admin-instance-projects
spring.cloud.gateway.routes[3].uri=lb://rs-admin-instance
spring.cloud.gateway.routes[3].predicates[0]=Path=/rs-admin-instance-public/**/projects/*
spring.cloud.gateway.routes[3].filters[0]=StripPrefix=2

# admin instance password route
spring.cloud.gateway.routes[4].id=rs-admin-instance-password
spring.cloud.gateway.routes[4].uri=lb://rs-admin-instance
spring.cloud.gateway.routes[4].predicates[0]=Path=/rs-admin-instance-public/**/accounts/password
spring.cloud.gateway.routes[4].filters[0]=StripPrefix=2

# admin instance notifications route
spring.cloud.gateway.routes[5].id=rs-admin-instance-notifications
spring.cloud.gateway.routes[5].uri=lb://rs-admin-instance
spring.cloud.gateway.routes[5].predicates[0]=Path=/rs-admin-instance-public/**/notifications
spring.cloud.gateway.routes[5].filters[0]=StripPrefix=2

# admin instance notifications id route
spring.cloud.gateway.routes[6].id=rs-admin-instance-notifications-id
spring.cloud.gateway.routes[6].uri=lb://rs-admin-instance
spring.cloud.gateway.routes[6].predicates[0]=Path=/rs-admin-instance-public/**/notifications/*
spring.cloud.gateway.routes[6].filters[0]=StripPrefix=2

# admin instance notifications read route
spring.cloud.gateway.routes[7].id=rs-admin-instance-notifications-read
spring.cloud.gateway.routes[7].uri=lb://rs-admin-instance
spring.cloud.gateway.routes[7].predicates[0]=Path=/rs-admin-instance-public/**/notifications/*/read
spring.cloud.gateway.routes[7].filters[0]=StripPrefix=2

# admin instance notifications delete route
spring.cloud.gateway.routes[8].id=rs-admin-instance-notifications-delete
spring.cloud.gateway.routes[8].uri=lb://rs-admin-instance
spring.cloud.gateway.routes[8].predicates[0]=Path=/rs-admin-instance-public/**/notifications/read/delete
spring.cloud.gateway.routes[8].filters[0]=StripPrefix=2

# admin instance notifications read all route
spring.cloud.gateway.routes[9].id=rs-admin-instance-notifications-read-all
spring.cloud.gateway.routes[9].uri=lb://rs-admin-instance
spring.cloud.gateway.routes[9].predicates[0]=Path=/rs-admin-instance-public/**/notifications/all/read
spring.cloud.gateway.routes[9].filters[0]=StripPrefix=2

## RS-ADMIN
# admin resources route
spring.cloud.gateway.routes[10].id=rs-admin-resources
spring.cloud.gateway.routes[10].uri=lb://rs-admin
spring.cloud.gateway.routes[10].predicates[0]=Path=/rs-admin-public/**/resources
spring.cloud.gateway.routes[10].filters[0]=StripPrefix=2

# admin roles route
spring.cloud.gateway.routes[11].id=rs-admin-roles
spring.cloud.gateway.routes[11].uri=lb://rs-admin
spring.cloud.gateway.routes[11].predicates[0]=Path=/rs-admin-public/**/roles/borrowables
spring.cloud.gateway.routes[11].filters[0]=StripPrefix=2

# admin notifications route
spring.cloud.gateway.routes[12].id=rs-admin-notifications
spring.cloud.gateway.routes[12].uri=lb://rs-admin
spring.cloud.gateway.routes[12].predicates[0]=Path=/rs-admin-public/**/notifications
spring.cloud.gateway.routes[12].filters[0]=StripPrefix=2

# admin notifications id route
spring.cloud.gateway.routes[13].id=rs-admin-notifications-id
spring.cloud.gateway.routes[13].uri=lb://rs-admin
spring.cloud.gateway.routes[13].predicates[0]=Path=/rs-admin-public/**/notifications/*
spring.cloud.gateway.routes[13].filters[0]=StripPrefix=2

# admin notifications read route
spring.cloud.gateway.routes[14].id=rs-admin-notifications-read
spring.cloud.gateway.routes[14].uri=lb://rs-admin
spring.cloud.gateway.routes[14].predicates[0]=Path=/rs-admin-public/**/notifications/*/read
spring.cloud.gateway.routes[14].filters[0]=StripPrefix=2

# admin notifications delete route
spring.cloud.gateway.routes[15].id=rs-admin-notifications-delete
spring.cloud.gateway.routes[15].uri=lb://rs-admin
spring.cloud.gateway.routes[15].predicates[0]=Path=/rs-admin-public/**/notifications/read/delete
spring.cloud.gateway.routes[15].filters[0]=StripPrefix=2

# admin notifications read all route
spring.cloud.gateway.routes[16].id=rs-admin-notifications-read-all
spring.cloud.gateway.routes[16].uri=lb://rs-admin
spring.cloud.gateway.routes[16].predicates[0]=Path=/rs-admin-public/**/notifications/all/read
spring.cloud.gateway.routes[16].filters[0]=StripPrefix=2

# admin users route
spring.cloud.gateway.routes[17].id=rs-admin-users
spring.cloud.gateway.routes[17].uri=lb://rs-admin
spring.cloud.gateway.routes[17].predicates[0]=Path=/rs-admin-public/**/users/myuser
spring.cloud.gateway.routes[17].filters[0]=StripPrefix=2

# admin accesses route
spring.cloud.gateway.routes[18].id=rs-admin-accesses
spring.cloud.gateway.routes[18].uri=lb://rs-admin
spring.cloud.gateway.routes[18].predicates[0]=Path=/rs-admin-public/accesses
spring.cloud.gateway.routes[18].filters[0]=StripPrefix=2

# admin accesses route
spring.cloud.gateway.routes[19].id=rs-admin-accesses-email
spring.cloud.gateway.routes[19].uri=lb://rs-admin
spring.cloud.gateway.routes[19].predicates[0]=Path=/rs-admin-public/accesses/verifyEmail/*
spring.cloud.gateway.routes[19].filters[0]=StripPrefix=2

# admin accesses route
spring.cloud.gateway.routes[20].id=rs-admin-accesses-settings
spring.cloud.gateway.routes[20].uri=lb://rs-admin
spring.cloud.gateway.routes[20].predicates[0]=Path=/rs-admin-public/accesses/settings
spring.cloud.gateway.routes[20].filters[0]=StripPrefix=2


## REDIRECTION EXAMPLE
# to redirect specific url follow the example below
#spring.cloud.gateway.routes[21].id=redirect-example
#spring.cloud.gateway.routes[21].uri=https://example.com
#spring.cloud.gateway.routes[21].predicates[0]=Path=/redirectPath
#spring.cloud.gateway.routes[21].filters[0]=RedirectTo=302, https://example.com